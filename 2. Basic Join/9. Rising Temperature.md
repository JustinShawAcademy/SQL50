## 197. [Rising Temperature](https://leetcode.com/problems/rising-temperature/description/?envType=study-plan-v2&envId=top-sql-50)
* Easy Problem

### SQL Solution
#### Concepts / Syntax
`INTERVAL`, `Date arithmetic`

#### Intuition
Right now, the `Weather` table has one row per day, and nothing in a single row tells what happened yesterday. Therefore, in order the gather this information to do the comparison of each day’s weather to the previous day’s weather, we must use a self `JOIN` to *line up*:
- Today’s row
with
- Yesterday’s row
Once we pair each day with yesterday, we can then check if the day resulted in a higher temperature.

#### Approach
1. We want to self join the `Weather` table to match each day to the previous day’s record. This can be done with `ON w1.recordDate = w2.recordDate + INTERVAL '1 day'` which tells us "Find rows where `w1` occurs one day after `w2`"
```sql
SELECT *
FROM Weather w1
JOIN Weather w2
ON w1.recordDate = w2.recordDate + INTERVAL '1 day' 
``` 
```
| id | recorddate | temperature | id | recorddate | temperature |
| -- | ---------- | ----------- | -- | ---------- | ----------- |
| 2  | 2015-01-02 | 25          | 1  | 2015-01-01 | 10          |
| 3  | 2015-01-03 | 20          | 2  | 2015-01-02 | 25          |
| 4  | 2015-01-04 | 30          | 3  | 2015-01-03 | 20          |
```

2. Now we must filter the rows so that we may only have w1 temperatures greater than w2 temperatures. In other words, days where the temperatrue was greater than the previous day.
```sql
SELECT *
FROM Weather w1
JOIN Weather w2
ON w1.recordDate = w2.recordDate + INTERVAL '1 day' 
WHERE w1.temperature > w2.temperature
```
```
| id | recorddate | temperature | id | recorddate | temperature |
| -- | ---------- | ----------- | -- | ---------- | ----------- |
| 2  | 2015-01-02 | 25          | 1  | 2015-01-01 | 10          |
| 4  | 2015-01-04 | 30          | 3  | 2015-01-03 | 20          |
```

3. Now we just simply update the `SELECT` to get only the `id`
```
SELECT w1.id
FROM Weather w1
JOIN Weather w2
ON w1.recordDate = w2.recordDate + INTERVAL '1 day' 
WHERE w1.temperature > w2.temperature
```
```
| id |
| -- |
| 2  |
| 4  |
```


#### Code
```sql
SELECT w1.id
FROM Weather w1
JOIN Weather w2
ON w1.recordDate = w2.recordDate + INTERVAL '1 day' 
WHERE w1.temperature > w2.temperature
```

### Pandas Solution
#### Code
```py
import pandas as pd

def rising_temperature(weather: pd.DataFrame) -> pd.DataFrame:
    # Cast column to datetime type
    weather["recordDate"] = pd.to_datetime(weather["recordDate"])

    df = weather.merge(weather, 
    left_on="recordDate",
    right_on=weather["recordDate"] + pd.Timedelta(days=1), # yesterday
    suffixes=("", "_yesterday") # no suffix on left columns
    )

    results = df[df["temperature"] > df["temperature_yesterday"]]
    return results[["id"]]
```
