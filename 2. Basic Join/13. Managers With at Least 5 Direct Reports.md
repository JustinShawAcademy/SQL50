## 570. [Managers with at Least 5 Direct Reports](https://leetcode.com/problems/managers-with-at-least-5-direct-reports/description/?envType=study-plan-v2&envId=top-sql-50)
* Medium Problem

### SQL Solution
#### Concepts / Syntax
`GROUP BY`, `HAVING`,  `SELF JOIN`

#### Intuition
In the `Employee` table, we could `GROUP BY` managerId followed by a `HAVING` to find the managers that has more than 5 employees. However, we would NOT know the manager name rather only the managerId. This is where a self `JOIN` comes in handy. If we self `JOIN` `Employee` to `Employee`, we can have it so that each row now has the managers name.  

#### Approach
1. Self `JOIN` `Employee` onto it's self.
```sql
SELECT *
FROM Employee mgr
JOIN Employee emp
ON mgr.id = emp.managerId
```
```
| id  | name | department | managerId | id  | name  | department | managerId |
| --- | ---- | ---------- | --------- | --- | ----- | ---------- | --------- |
| 101 | John | A          | null      | 102 | Dan   | A          | 101       |
| 101 | John | A          | null      | 103 | James | A          | 101       |
| 101 | John | A          | null      | 104 | Amy   | A          | 101       |
| 101 | John | A          | null      | 105 | Anne  | A          | 101       |
| 101 | John | A          | null      | 106 | Ron   | B          | 101       |
```

2. `GROUPBY` the manager ID and use `HAVING` to filter the managers that have less than 5 employees.
```sql
SELECT *
FROM Employee mgr
JOIN Employee emp
ON mgr.id = emp.managerId
GROUP BY mgr.id
HAVING COUNT(*) >= 5
```
```
| id  | name | department | managerId | id  | name | department | managerId |
| --- | ---- | ---------- | --------- | --- | ---- | ---------- | --------- |
| 101 | John | A          | null      | 102 | Dan  | A          | 101       |
```

3. `SELECT` the managers name.
```sql
SELECT mgr.name
FROM Employee mgr
JOIN Employee emp
ON mgr.id = emp.managerId
GROUP BY mgr.id
HAVING COUNT(*) >= 5
```
```
| name |
| ---- |
| John |
```

#### Code
```sql
SELECT mgr.name
FROM Employee mgr
JOIN Employee emp
ON mgr.id = emp.managerId
GROUP BY mgr.id
HAVING COUNT(*) >= 5
```